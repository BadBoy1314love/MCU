C51 COMPILER V9.60.0.0   ____________________2                                             04/15/2020 14:43:53 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE ____________________2
OBJECT MODULE PLACED IN .\Objects\红外传感器控制电磁阀2.obj
COMPILER INVOKED BY: C:\PersonalProgramFiles\Keil5\C51\BIN\C51.EXE 红外传感器控制电磁阀2.c OPTIMIZE(8,SPEED) BROWSE DEBU
                    -G OBJECTEXTEND PRINT(.\Listings\红外传感器控制电磁阀2.lst) TABS(2) OBJECT(.\Objects\红外传感器控制电磁阀2.obj)

line level    source

   1          #include <STC15.h>
   2          #include <intrins.h>
   3          
   4          sbit Relay=P1^1;              //继电器  用于间接控制电磁阀
   5          sbit Infrared_sensor=P1^2;   //红外传感器  用于控制继电器的开启与关闭
   6          
   7          void Delay10ms()    //@12.000MHz
   8          {
   9   1        unsigned char i, j;
  10   1      
  11   1        i = 117;
  12   1        j = 184;
  13   1        do
  14   1        {
  15   2          while (--j);
  16   2        } while (--i);
  17   1      }
  18          
  19          void main()
  20          {
  21   1        Relay=1;           //继电器断开状态
  22   1        while(1)
  23   1        {
  24   2          unsigned int a=0; 
  25   2          P1:
  26   2          Relay=1;           //继电器断开状态
  27   2          if(Infrared_sensor==0)         //如果传感器检测到物体
  28   2          {
  29   3            while(1)                     //继电器持续断开，直到传感器检测不到物体，去P2
  30   3            {
  31   4              Relay=1;
  32   4              if(Infrared_sensor==1)          
  33   4              {
  34   5                goto P2;
  35   5              } 
  36   4            }
  37   3            
  38   3            P2:
  39   3            for(a=0;a<=30000;a++)          //延时5min，且在5min内继电器状态都为闭合
  40   3            {
  41   4              Relay=0;
  42   4              Delay10ms();
  43   4              if(Infrared_sensor==0)        //5min延时内，如果检测到物体，继电器持续闭合
  44   4              {
  45   5                while(1)
  46   5                {
  47   6                  Relay=0;
  48   6                  if(Infrared_sensor==1)     //当传感器检测不到物体时，去P1
  49   6                  {
  50   7                  goto P1;
  51   7                  }
  52   6                }
  53   5              }
  54   4            }
C51 COMPILER V9.60.0.0   ____________________2                                             04/15/2020 14:43:53 PAGE 2   

  55   3          }
  56   2        }
  57   1      }
  58          
  59          
  60          /*
  61          void delay30ms()    //@12.000MHz
  62          {
  63            unsigned char i, j, k;
  64          
  65            _nop_();
  66            _nop_();
  67            i = 2;
  68            j = 95;
  69            k = 43;
  70            do
  71            {
  72              do
  73              {
  74                while (--k);
  75              } while (--j);
  76            } while (--i);
  77          }
  78          
  79          
  80          void delay50ms()    //@12.000MHz
  81          {
  82            unsigned char i, j, k;
  83          
  84            _nop_();
  85            _nop_();
  86            i = 3;
  87            j = 72;
  88            k = 161;
  89            do
  90            {
  91              do
  92              {
  93                while (--k);
  94              } while (--j);
  95            } while (--i);
  96          }
  97          */
  98          
  99          /*
 100          void Delay60ms()    //@12.000MHz
 101          {
 102            unsigned char i, j, k;
 103          
 104            _nop_();
 105            _nop_();
 106            i = 3;
 107            j = 189;
 108            k = 92;
 109            do
 110            {
 111              do
 112              {
 113                while (--k);
 114              } while (--j);
 115            } while (--i);
 116          }
C51 COMPILER V9.60.0.0   ____________________2                                             04/15/2020 14:43:53 PAGE 3   

 117          
 118          void Delay100ms()   //@12.000MHz
 119          {
 120            unsigned char i, j, k;
 121          
 122            _nop_();
 123            _nop_();
 124            i = 5;
 125            j = 144;
 126            k = 71;
 127            do
 128            {
 129              do
 130              {
 131                while (--k);
 132              } while (--j);
 133            } while (--i);
 134          }
 135          
 136          
 137          
 138          void Delay500ms()   //@12.000MHz
 139          {
 140            unsigned char i, j, k;
 141            _nop_();
 142            _nop_();
 143            i = 23;
 144            j = 205;
 145            k = 120;
 146            do
 147            {
 148              do
 149              {
 150                while (--k);
 151              } while (--j);
 152            } while (--i);
 153          }
 154          
 155          void Delay1min()
 156          {
 157            unsigned int a=0;
 158            for(a=0;a<=120;a++)
 159            {
 160              Delay500ms();
 161            }
 162          }
 163          
 164          void Delay5min()
 165          {
 166            unsigned int a=0;
 167            for(a=0;a<=600;a++)
 168            {
 169              Delay500ms();
 170            }
 171          }
 172          */
 173            
 174          
 175          /*
 176          
 177          误差较大的延时
 178          void delay30ms(void)   //误差 -0.000000000002us
C51 COMPILER V9.60.0.0   ____________________2                                             04/15/2020 14:43:53 PAGE 4   

 179          {
 180              unsigned char a,b,c;
 181              for(c=3;c>0;c--)
 182                  for(b=212;b>0;b--)
 183                      for(a=140;a>0;a--);
 184          }
 185          
 186          void delay50ms(void)   //误差 -0.000000000003us
 187          {
 188              unsigned char a,b,c;
 189              for(c=123;c>0;c--)
 190                  for(b=116;b>0;b--)
 191                      for(a=9;a>0;a--);
 192          }
 193          */
 194          
 195          
 196          /*
 197          之前写的一部分代码参考
 198          void main()
 199          {
 200            Initialize();
 201            while(1)
 202            {
 203              if(Infrared_sensor==0)
 204              {
 205                Infrared_sensor=0;
 206                delay50ms();
 207                Infrared_sensor=1;
 208                Relay=~Relay;
 209              }
 210              while(Infrared_sensor);
 211            }
 212          }
 213          
 214          
 215          
 216          
 217          void main()
 218          {
 219            Initialize();     //上电初始化
 220            while(1)
 221            {
 222              unsigned int a=0;
 223              Relay=1;          //继电器复位
 224              P1:
 225              if(Infrared_sensor1==0)     //如果红外传感器1检测到物体
 226              {
 227                P2:
 228                Infrared_sensor1=0;                
 229                Delay100ms();             //保持传感器输出为0持续100ms，即检测到物体持续100ms
 230                Infrared_sensor1=1;       //控制传感器1输出为1，取消保持
 231                
 232                if(Infrared_sensor2==0)     //如果红外传感器2受到阻挡
 233                {
 234                  Infrared_sensor2=0;
 235                  Delay60ms();             //保持传感器输出为0持续60ms，即认为有物体持续阻挡了60ms
 236                  Infrared_sensor2=1;      //控制传感器2输出为1，取消保持
 237                  while(1)
 238                  {
 239                    Relay=1;              //初始化传感器1与传感器2与以及继电器
 240                    if(Infrared_sensor2==1)    //如果传感器2没有被阻挡，则跳出循环
C51 COMPILER V9.60.0.0   ____________________2                                             04/15/2020 14:43:53 PAGE 5   

 241                    {
 242                      break;
 243                    }
 244                  }
 245                }
 246                Relay=~Relay;             //继电器状态翻转
 247                for(a=0;a<=6000;a++)
 248                {
 249                  Delay50ms();
 250                  if(Infrared_sensor1==0||Infrared_sensor2==0)  //在延时过程中有任何一个传感器受到阻挡即刻退出
 251                  {
 252                    goto P1;
 253                  }
 254                }     //继电器持续运行的最大时间5min
 255              }
 256              if(Infrared_sensor2==0)     //如果红外传感器2先受到阻挡
 257              {
 258                goto P2;
 259              }
 260            }
 261          }
 262          */
 263          
 264          
 265          /*
 266          void main()
 267          {
 268            Initialize();
 269            while(1)
 270            {
 271              unsigned int a=0; 
 272              Initialize();
 273              if(Infrared_sensor1==0)
 274              {
 275                while(1)
 276                {
 277                  Relay=1;
 278                  if(Infrared_sensor1==1)
 279                  {
 280                    Relay=0;
 281                  }
 282                  break;
 283                }
 284                
 285                for(a=0;a<=6000;a++)
 286                {
 287                Delay50ms();
 288                if(Infrared_sensor1==0)
 289                {
 290                  Relay=1;
 291                  break;
 292                }
 293                while(!Infrared_sensor1);
 294                }
 295              }
 296            }
 297            
 298          }
 299          
 300          */


C51 COMPILER V9.60.0.0   ____________________2                                             04/15/2020 14:43:53 PAGE 6   

MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     67    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
